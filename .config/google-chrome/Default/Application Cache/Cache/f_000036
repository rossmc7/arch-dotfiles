function B2b(a,b,c,d){var e=null;a.B.every(function(a,h,k){if(b&&(h>c||h==c&&k>=d))return!1;a.isEmpty()||(e=new N(k,h));return!0});return e}function C2b(a,b,c){var d=null;a.B.some(function(a,f,h){return(f>b||f==b&&h>c)&&!a.isEmpty()?(d=new N(h,f),!0):!1});return d}pL.prototype.fta=aS(168,function(a,b,c,d){for(var e=a-1,f=this.C.length;0<=e;){var h=this.C[e--];if(!(h.getSheetType()!=b||h.D&&d))return h}if(!c)return null;for(e=f-1;e>=a;)if(c=this.C[e--],!(c.getSheetType()!=b||c.D&&d))return c;return null});
sj.prototype.Os=aS(30,function(){return!!Lg(this,"ip")});function D2b(a,b){var c=Bu(a.C);Vb(a.X,function(a,e){var f=this.J.Oo(a);+e==c&&b?go(f,"docs-icon-comment-blank-highlighted"):io(f,"docs-icon-comment-blank-highlighted")},a)}function E2b(a,b,c){var d=0,e=-1;b&&(d=b.y,e=b.x);var f=null;return f=c?B2b(a,!!b,d,e):C2b(a,d,e)}function F2b(a,b){if(!b)return null;var c=null;a.B.some(function(a,e,f){a=a.Uc();for(var h=0;h<a.length;h++)if(a[h]==b)return c=new N(f,e),!0;return!1});return c}
function G2b(a){var b=new zg;a.B.forEach(function(a){a.isEmpty()||Ag(b,a.Uc())});return b.Uc()}function H2b(a,b){var c=a.B.xe(b.y,b.x);return c?c.Uc():[]}function o0(a){return a.B.hasUnpostedDocos()}function I2b(a,b){for(var c=[],d=0;d<b.length;d++)c.push(a.C.B[b[d]]||0);a.B.deleteDocoPositions(c)}function J2b(a,b){var c={},d;for(d in b){var e=a.C.B[d]||0;if(e&&a.B.hasDoco(e)){var f=b[d];c[e]=new Docos.Point(f.x,f.y)}}return c}var K2b={qQb:1,HOVER:2,YJa:3};
function p0(a,b,c){zw.call(this,10100,b);this.vb=a;this.C=b;this.F=c}y(p0,zw);p0.prototype.Qd=p(35);p0.prototype.Nd=function(){var a=new Tv,b=Xh(this.F,this.C);E(a,1,this.vb);E(a,2,b);return a};p0.prototype.Ri=Cc;function L2b(a){this.B={};if(a)for(var b in a)this.set(b,a[b])}L2b.prototype.get=function(a){if(!(a in this.B))throw Error("No value for key "+a);return this.B[a]};L2b.prototype.set=function(a,b){this.B[a]=b};function M2b(a){this.B=new L2b;this.C=a||null}M2b.prototype.Mc=function(a){try{var b=Di(a)}catch(c){return this.C&&this.C.log(Error("Invalid serialized anchor ID")),null}return this.B.get(b.type).Mc(b)};M2b.prototype.Vb=function(a){return Fi(this.B.get(a.getType()).Vb(a))};function q0(a,b){this.D=a;this.C=b}q0.prototype.getType=g("D");function N2b(a){q0.call(this,"range",0);this.F=a}y(N2b,q0);N2b.prototype.B=g("F");function O2b(){}ja(O2b);O2b.prototype.Mc=function(a){return new N2b(a.range)};O2b.prototype.Vb=function(a){var b={};b.type=a.getType();b.uid=a.C;b.range=a.B();return b};function r0(a,b){q0.call(this,"workbook-range",0);this.G=a;this.F=!!b}y(r0,q0);r0.prototype.B=g("G");function P2b(){}ja(P2b);P2b.prototype.Mc=function(a){return new r0(a.range)};P2b.prototype.Vb=function(a){var b={};b.type=a.F?"range":"workbook-range";b.uid=a.C;b.range=a.B();return b};function s0(){M2b.call(this);var a=O2b.getInstance();this.B.set("range",a);a=P2b.getInstance();this.B.set("workbook-range",a)}y(s0,M2b);ja(s0);s0.prototype.Mc=function(a){a=s0.O.Mc.call(this,a);if(!a)return null;"range"==a.getType()&&(a=new r0(a.B(),!0));return a};function t0(a,b){if(!b)return null;var c=b.B();return"range"==b.getType()?(c=a.B[c],Q2b(c)?c.hc().Yd():null):(c=R2b(b))&&S2b(T2b(c))?T2b(c).Yd():null}function R2b(a){var b=new ph,c;try{c=ritz.getWorkbookRangeById(a.B(),!0)}catch(d){}return c?b.Mc((new rd).ma(),ritz.getWorkbookRangeById(a.B(),!0)):null}function T2b(a){return new Ch(a.Ob(),a.Fb(),a.mc(),a.zc())}
function u0(a,b,c){return c?"range"==c.getType()?(b=b.B[c.B()],Q2b(b)?(b=b.Qb(),null!=b?U2b(a,b):null):null):(b=R2b(c))&&S2b(T2b(b))?U2b(a,parseInt(b.eb(),10)):null:null}function U2b(a,b){var c=xz(a,b);return c?c.vc():null}function Q2b(a){return!!a&&a.B&&S2b(a.hc())}function S2b(a){return!!a&&Hga(a)&&Rh(a)};function V2b(a,b,c,d,e,f,h,k,l,m,n){H.call(this);this.D=a;this.Ha=b;this.V=c;this.Ia=d;this.J=e;this.Ca=f;this.Y=h;this.Ka=k;this.B=l;this.X=m;this.G=b.Ka;this.C=b.B;this.F=b.M;this.K=s0.getInstance();this.R={};this.P=new zg;this.xa=new jk(0);a=[this.xa];Ib(n.C,a);Tva(n,a);n.B=Rva(n.C);Sva(n);this.M=new M(this);W2b(this)}y(V2b,H);r=V2b.prototype;r.Qfa=!1;
function W2b(a){var b=qb(rAa,function(a){return!uAa[a]});a.M.L(a.Ia,"activity-box-closed",a.N3a).L(a.J,"mouseover",v0(a,a.eab)).L(a.J,"click",v0(a,a.cab)).L(a.J,"selectionChange",v0(a,a.fab)).L(a.J,"inputBoxActivate",v0(a,a.aab)).L(a.J,"hide_docos",v0(a,a.dab)).L(a.C,"Ob",v0(a,a.pqb)).L(a.Y,"view-comments",a.z8a).L(a.Y,"comment-indicator-hover-start",a.x8a).L(a.Y,"comment-indicator-hover-end",a.w8a).L(a.J,"insert_doco",a.mqb).L(new Ot(a.Ka),"mousewheel",a.nqb).L(a.F,["add_named_range","delete_named_range"],
a.x4a).L(a.Ha,"docos_change",a.pab).L(a.X,"df",a.SVa).L(a.C,"Nb",a.gxa);var c=Ku(a.C);a.M.L(c,b,a.bab);a.M.L(c,["qb"],v0(a,a.oqb));mD(a.D,Docos.EventType.HOVER,v0(a,a.EZa));mD(a.D,Docos.EventType.SELECTED,v0(a,a.lqb));mD(a.D,Docos.EventType.CREATED,a.Kva,a);mD(a.D,Docos.EventType.UNRESOLVED,a.Kva,a);mD(a.D,Docos.EventType.DELETED,a.Lva,a);mD(a.D,Docos.EventType.RESOLVED,a.Lva,a);mD(a.D,Docos.EventType.POSTED,a.d_a,a);mD(a.D,Docos.EventType.PENDING,a.E5a,a);Z.Nr.Hc(Om,v(a.X1a,a));Q.Ev.Hc(Om,v(a.DVa,
a));Q.a4.subscribe("action",v(a.j4a,a));Q.b4.subscribe("action",v(a.s4a,a));Q.c4.subscribe("action",v(a.t4a,a));a.gxa()}r.gxa=function(){var a=Mu(this.C);Q.a4.Da(a);Q.b4.Da(a);Q.c4.Da(a)};r.X1a=function(){this.D.setOption(Docos.OptionName.READONLY,!this.Ha.GC())};function v0(a,b){return v(function(a){this.Qfa||b.call(this,a)},a)}
r.mqb=function(){var a=Nu(this.C),b=KA(a);if(b&&!o0(this.D)&&!X2b(this,a,b)){var c=ritz.getNewWorkbookRangeId();this.Ca.B(new p0(c,a.Qb(),Eh(b)));a=this.K.Vb(new r0(c));if(a=w0(this,a))this.B.dispatchEvent(new x0("mf",[a],b)),this.V.qc(2)}};function X2b(a,b,c){c=H2b(MC(a.G,b),c);return c.length?(b=a.D,a=a.K.Vb(c[0]),b.B.highlightDoco(b.C.B[a]||0,!0),!0):!1}r.Kva=function(a){A(a.B,function(a){y0(this,!0,a);this.P.add(a)},this)};r.Lva=function(a){A(a.B,function(a){y0(this,!1,a);this.P.remove(a)},this)};
function y0(a,b,c,d,e){c=w0(a,c);d=d||u0(a.C,a.F,c);e=e||t0(a.F,c);if(c&&d&&e){var f=MC(a.G,d);if(b){var h=f.B.xe(e.y,e.x)||new zg;h.add(c);By(f.B,e.y,e.x,h)}else(h=f.B.xe(e.y,e.x))&&h.remove(c);By(f.C,e.y,e.x,!0);f.F.Kb()||f.F.start();a.C.getActiveGrid()&&(d=d==Nu(a.C),b?(a=a.B,(b=d?e:null)&&qh(b,a.ZJ)&&a.B.add(c),a.dispatchEvent(new x0("ef",[c],b))):(a=a.B,(b=d?e:null)&&qh(b,a.ZJ)&&a.B.remove(c),a.Xs==c&&(a.Xs=null),a.dispatchEvent(new x0("of",[c],b))))}else a.B.dispatchEvent("qf")}
function w0(a,b){if(!b)return null;if(!a.R[b]){var c=a.K.Mc(b);c&&(a.R[b]=c)}return a.R[b]}r.pqb=function(){this.B.reset()};r.EZa=function(a){a=w0(this,a.B.length?a.B[0]:null);var b=t0(this.F,a);this.B.dispatchEvent(new x0("jf",[a],b))};r.d_a=ba();r.E5a=function(){var a=this.xa,b=this.D.B.hasPendingContent();kk(a,ik(a.Ea,4,b))};r.N3a=function(){this.V.qc(3)};
r.lqb=function(a){if(!o0(this.D)){var b=w0(this,a.B.length?a.B[0]:null),c=t0(this.F,b);b&&c?(this.Qfa=!0,Y2b(this.B,b,c)):b||a.F?this.B.reset():b||this.V.qc(3)}};r.SVa=function(){this.Qfa=!1};r.dab=function(){this.B.dispatchEvent("lf")};r.fab=function(){if(!this.X.isEmpty()&&!o0(this.D)){this.V.qc(3);var a=this.B,b=KA(Nu(this.C));qh(a.zL,b)||!a.Xs&&!a.Tu&&qh(a.ZJ,b)||(z0(a),a.dispatchEvent(new x0("hf",[],b)))}};
r.cab=function(){var a=Nu(this.C);if(!o0(this.D)&&a){var b=MC(this.G,a),c=(a=KA(a))?H2b(b,a):[];c.length&&(b=this.B,c=c[0],qh(b.zL,a)?(z0(b),b.dispatchEvent(new x0("ff",[],a))):b.dispatchEvent(new x0("ff",[c],a)))}};r.aab=function(){o0(this.D)||this.B.reset()};r.oqb=function(){Z2b(this.B)};r.bab=function(){Z2b(this.B)};
r.x4a=function(a){var b=a.Te;if(b&&b.B)if(Q2b(b)){var c;c=b.getId();c=this.K.Vb(new N2b(c));a="add_named_range"==a.type;if(!a||this.P.contains(c)){var d=b.Qb();b.Af()&&null!=d&&(d=U2b(this.C,d))&&y0(this,a,c,d,b.hc().Yd())}}else this.B.dispatchEvent("qf")};
r.pab=function(a){a=a.docos||[];Kb(a);for(var b=0;b<a.length;b++){var c=this.K.Vb(new r0(a[b]));if(c){var d=w0(this,c),e;a:{e=this.G;if(d){var f=void 0;for(f in e.B){var h=e.B[f],k=F2b(h,d);if(k){e={Ra:h.vc(),CNa:k};break a}}}e=null}e?(y0(this,!1,c,e.Ra,e.CNa),y0(this,!0,c),this.B.dispatchEvent("qf")):this.P.contains(c)&&y0(this,!0,c)}}};
r.eab=function(a){var b=Nu(this.C);if(b){if((a=a.ag)&&!zD(a)){var c=Yz(b,a.y,a.x);a=c?c.Yd():a}else a=null;b=MC(this.G,b);b=a?H2b(b,a):[];c=this.B;c.B.clear();Ag(c.B,b);c.ZJ=a;c.dispatchEvent(new x0("gf",b,a))}};r.z8a=function(){if(!o0(this.D)){var a=this.B;if(a.Tu&&a.nS)a.nS=!1;else{var b=!a.Tu;z0(a);a.Tu=b;a.dispatchEvent("nf")}}};r.x8a=function(){if(!o0(this.D)){var a=this.B;a.Tu||(z0(a),a.nS=!0,a.Tu=!0,a.dispatchEvent("nf"))}};r.w8a=function(){if(!o0(this.D)){var a=this.B;a.Tu&&a.nS&&(z0(a),a.dispatchEvent("nf"))}};
r.nqb=function(a){a.stopPropagation()};r.sTa=function(a){var b=w0(this,a);a=u0(this.C,this.F,b);if(!b||!a)return"";b=t0(this.F,b);a=BA(a,b).getDisplayValue();500<a.length&&(a=a.substring(0,499),a+="\u2026");return a};r.DVa=function(){var a;a=this.D;var b=a.B.getLinkedDoco();if(a=a.C.C[b]||null||"")(a=w0(this,a))?(b=t0(this.F,a),Y2b(this.B,a,b)):Q.Ev.$b()};r.j4a=function(){var a=Nu(this.C);X2b(this,a,KA(a))};r.s4a=function(){$2b(this,!1)};r.t4a=function(){$2b(this,!0)};
function $2b(a,b){for(var c=a3b(a,b),d=fB(a.C),e=Nu(a.C),f=KA(e),h=MC(a.G,e),f=E2b(h,f,b),k=d;!f&&null!==k&&(k=c(k),e=k.vc(),h=MC(a.G,e),f=E2b(h,null,b),k=k.Ze,k!=d););f&&null!==k&&(c=H2b(h,f)[0],by(a.C,k,v(a.qqb,a,e,c,f)))}function a3b(a,b){var c;c=b?v(a.C.fta,a.C):v(a.C.pZ,a.C);return function(a){return c(a,0,!0,!0)}}r.qqb=function(a,b,c){Y2b(this.B,b,c);OA(a,c)};
r.T=function(){delete this.J;delete this.Ka;delete this.K;delete this.R;delete this.D;delete this.G;delete this.F;delete this.Ca;delete this.C;delete this.Ha;J(this.xa);delete this.xa;J(this.X);delete this.X;J(this.B);delete this.B;J(this.M);delete this.M;V2b.O.T.call(this)};function x0(a,b,c){K.call(this,a);this.docos=b;this.F=b.length?b[0]:null;this.xl=c||null}y(x0,K);function b3b(){L.call(this);this.B=new zg}y(b3b,L);r=b3b.prototype;r.ZJ=null;r.zL=null;r.Xs=null;r.Tu=!1;r.nS=!1;function Y2b(a,b,c){z0(a);a.Xs=b;a.zL=c;a.dispatchEvent(new x0("kf",[b],c))}r.Os=g("Tu");function Z2b(a){a.Tu||a.Xs||z0(a);a.dispatchEvent("rf")}r.reset=function(){z0(this);this.dispatchEvent("pf")};function z0(a){a.ZJ=null;a.B.clear();a.zL=null;a.Xs=null;a.Tu=!1;a.nS=!1}r.T=function(){delete this.ZJ;delete this.B;delete this.zL;delete this.Xs;b3b.O.T.call(this)};function c3b(a,b,c,d,e,f){JE.call(this,a,b,c,d,e,2,0,f)}y(c3b,JE);c3b.prototype.Y=function(a){return nUa(this,a,"range-border cell-border waffle-docos-target-cell-border")};function d3b(a,b,c,d,e,f,h){L.call(this);this.D=a;this.Ka=b;this.F=c;this.Ha=d;this.J=e;this.B=f;this.P=b.Ka;this.C=b.B;this.K=b.M;this.M=s0.getInstance();this.Y=h||yl();this.G=new zg;this.R=new zg;this.V=new zg;this.X=new zg;this.xa=new M(this);e3b(this);this.xa.L(this.C,"Nb",this.uqb).L(this.B,"gf",this.eXa).L(this.B,"hf",this.gXa).L(this.B,"ff",this.dXa).L(this.B,"jf",this.FZa).L(this.B,"kf",this.rqb).L(this.B,"rf",this.tqb).L(this.B,"pf",this.sqb).L(this.B,"mf",this.c_a).L(this.B,"qf",this.k7a).L(this.B,
"ef",this.DZa).L(this.B,"of",this.GZa).L(this.B,"lf",this.HZa).L(this.B,"nf",this.J5a);f3b(this)}y(d3b,L);r=d3b.prototype;r.ju=null;r.U8="none";r.N0=500;r.cU=!1;r.HZa=function(){A0(this)};r.DZa=function(a){var b=a.F;b&&g3b(this,[b],!0);h3b(this,a.F)};r.GZa=function(a){var b=a.F;b&&i3b(this,[b]);h3b(this,a.F)};function h3b(a,b){var c=u0(a.C,a.K,b);if(c){var d=MC(a.P,c);gkb(a.Ha,c.Qb(),G2b(d).length)}else j3b(a)}r.J5a=function(){A0(this);this.B.Os()&&k3b(this)};r.gXa=function(){A0(this)};
r.dXa=function(a){if(a.F){var b=a.F;this.cU=!0;a=this.D;b=this.M.Vb(b);a.B.highlightDoco(a.C.B[b]||0,void 0);this.cU=!1}else A0(this)};r.tqb=function(){var a=this.B.Xs,b=this.G.isEmpty();this.B.Os()?k3b(this):a?(l3b(this,[a]),b&&!this.G.isEmpty()&&(this.cU=!0,b=this.D,a=this.M.Vb(a),b.B.highlightDoco(b.C.B[a]||0,void 0),this.cU=!1)):b||A0(this)};r.sqb=function(){A0(this)};
function A0(a){a.G.clear();var b=a.D;b.B.flushDocoPositions(J2b(b,{}));b=a.D;b.B.highlightDoco(b.C.B[""]||0,void 0);R(a.J,!1);J(a.ju);m3b(a);n3b(a);a.B.Os()||o3b(a);p3b(a,a.B.Os());f3b(a)}r.isEmpty=function(){return this.G.isEmpty()&&this.V.isEmpty()&&this.R.isEmpty()&&this.X.isEmpty()};function f3b(a){var b=Wx(a.F);b&&(a.N0=b.B.NQ()/2,a.D.setOption(Docos.OptionName.MAX_DOCO_HEIGHT,a.N0))}function n3b(a){rf(a.V.Uc());a.V.clear()}function m3b(a){rf(a.R.Uc());a.R.clear()}
function o3b(a){A(a.X.Uc(),function(a){io(a,"waffle-docos-target-cell-header")});a.X.clear()}r.eXa=function(a){this.B.Xs||this.B.Os()||(a=a.docos,a.length?l3b(this,a,!0):q3b(this,!1))};function l3b(a,b,c){o0(a.D)||i3b(a,Cg(a.G,b).Uc());g3b(a,b,c)}function k3b(a){var b=Nu(a.C);b&&(b=MC(a.P,b),l3b(a,G2b(b),!0),r3b(a),s3b(a))}r.rqb=function(a){t3b(this,a.F,a.xl)};
function t3b(a,b,c,d){var e=u0(a.C,a.K,b);if(e){var f=e.Qb();if(u3b(a,b)){var h=v3b(a,c),k=function(){w3b(this,c)&&!h.equals(LA(e))?(QA(e,h),t3b(this,b,c,d)):(Kz(BA(e,c))&&RI(Wx(this.F)).setVisible(!1),x3b(this,c),l3b(this,[b],!0),m3b(this),n3b(this),o3b(this),y3b(this,c),p3b(this,this.B.Os()),d&&Zj(function(){this.D.B.grabFocus()},0,this),this.dispatchEvent("df"))};al?qy(xy(xz(a.C,f)),v(e.sp,e,h)).addCallback(k,a):sy(xy(xz(a.C,f)),v(e.sp,e,h),v(k,a),new M)}else oL(a.C,f,v(function(){this.D.B.grabFocus();
t3b(this,b,c,!0)},a))}else a.dispatchEvent("df")}function x3b(a,b){var c=Nu(a.C),d=Wx(a.F);if(!a.cU&&c&&d){var e=d.B,d=d.C,f=e.Oz("waffle",!1,!1),h=212;if(!e.Rb()){var k=Dl("docs-docos-activitybox");k&&Io(k)&&(h+=f.right-Go(k).left)}k=z3b(a,b);h=k.x-f.right+h;f=k.y-f.bottom+a.N0;if(!(0>=h&&0>=f)){d=d.B.Yd();for(d=Dh(d.y,d.x,d.y,d.x);e.yQ(d).height<f;)d.height+=1;for(;e.yQ(d).width<h;)d.width+=1;e=d.height;d=d.width;RA(c,IJa(c,bA(c,IA(c),d,e)))}}}
function w3b(a,b){var c=Nu(a.C);return uA(ey(c,"r"),b.y)&&uA(ey(c,"c"),b.x)}function p3b(a,b){D2b(a.Ha,b)}function v3b(a,b){return Yz(Nu(a.C),b.y,b.x)||Eh(b)}
r.FZa=function(a){if(!this.B.Os()&&(m3b(this),u3b(this,a.F)&&(q3b(this,!0),this.B.Xs!=a.F))){var b=this.M.Vb(a.F),c=this.D;c.B.isDocoResolved(c.C.B[b]||0)?(b=a.xl,a=Wx(this.F),(c=Nu(this.C))&&a&&b&&(b=Yz(c,b.y,b.x)||Eh(b),b=qI(a,b,"waffle-docos-target-cell-resolved-rect"),XD(rI(a),b,!0),b.setVisible(!0),this.R.add(b))):(c=a.xl,a=Wx(this.F),(b=Nu(this.C))&&a&&c&&(c=Yz(b,c.y,c.x)||Eh(c),b=new c3b(b,a.J,a.B,a.C,new RD(c),this.Y),XD(rI(a),b,!0),this.R.add(b),b.setVisible(!0)))}};
function A3b(a,b){b&&(go(b,"waffle-docos-target-cell-header"),a.X.add(b))}function y3b(a,b){var c=Wx(a.F),d=Nu(a.C);d&&c&&b&&(d=Yz(d,b.y,b.x)||Eh(b),d=qI(c,d,"waffle-docos-target-cell-rect"),XD(rI(c),d,!0),a.V.add(d),d.setVisible(!0),d.getElement()&&a.xa.L(d.getElement(),["click","contextmenu","dblclick","mousedown","mouseup"],function(a){a.ag=b;c.dispatchEvent(a)}))}function r3b(a){n3b(a);var b={};A(a.G.Uc(),function(a){a=t0(this.K,a);var d=a.x+"-"+a.y;b[d]||(y3b(this,a),b[d]=!0)},a)}
function s3b(a){o3b(a);var b=Nu(a.C),c=Wx(a.F);if(b&&c){var d=c.J,c=c.C,b=MC(a.P,b),e=c.Qf("r"),f=c.Zf("r"),h=c.Qf("c"),k=c.Zf("c");A(G2b(b),function(a){a=t0(this.K,a);a.x>=h&&a.x<=k&&A3b(this,d.B.getElement(vE(d,"ch-",null,YA(d.D,a.x))));a.y>=e&&a.y<=f&&A3b(this,d.B.getElement(vE(d,"rh-",XA(d.D,a.y),null)))},a)}}r.k7a=function(){j3b(this)};function j3b(a){var b=rb(bc(a.P.B),Number);A(b,function(a){var b=U2b(this.C,a);b&&(b=MC(this.P,b),gkb(this.Ha,a,G2b(b).length))},a)}
r.c_a=function(a){if(a.F){var b=this.M.Vb(a.F),c=this.D;a=z3b(this,a.xl);a=u(a)?new Docos.Point(a.x,a.y):void 0;c.B.newDoco(b,a,void 0)}};
function g3b(a,b,c){for(var d={},e=[],f={},h=0;h<b.length;h++){var k=b[h],l=a.M.Vb(k),m;m=a;var n=k;if(Wx(m.F)&&u3b(m,n)){var q=t0(m.K,n);m=B3b(m,v3b(m,q))?m.B.Os()||m.B.Xs==n||xb(m.B.B.Uc(),n):!1}else m=!1;m?(m=t0(a.K,k),n=m=v3b(a,m),n=n.Ob()+"-"+n.mc()+"-"+n.Fb()+"-"+n.zc()+"-"+n.B+"-"+n.Id,f[n]=f[n]||0,d[l]=z3b(a,m.Yd(),f[n]),f[n]++,a.G.add(k)):e.push(k)}a.G.isEmpty()||q3b(a,!0);fc(d)||(b=a.D,b.B.updateDocoPositions(J2b(b,d)));o0(a.D)||i3b(a,e);if(c)for(c=a.G.Uc(),d=0;d<c.length;d++){e=a;b=c[d];
f=void 0;a:switch(f=b,f.getType()){case "range":break a;case "workbook-range":break a;default:throw Error("Invalid doco with type: "+f.getType());}f=t0(e.K,f);f=z3b(e,f);l=Wx(e.F);h=l.B;k=l.uh;k=k.D(k.B()-1);m=fy(Nu(e.C));l=l.C.Zf("r");h=h.Yf(new sh(m,l),"r");h+=k;k=tTb(Wx(e.F)).Rh("c");f=h-(f.y-k);f<e.N0&&b&&(b=e.M.Vb(b),e=e.D,e.B.setDocoMaxHeight(e.C.B[b]||0,125>f?125:f))}}
function i3b(a,b){var c=Bg(a.G,b).Uc();a.G.Wb(c);c=rb(c,function(a){return this.M.Vb(a)},a);c.length&&I2b(a.D,c);a.G.isEmpty()&&q3b(a,!1)}
function z3b(a,b,c){var d=Wx(a.F),e=Nu(a.C),f=d.B,h=f.Rb(),k=v3b(a,b),l=f.us(k),m=c?15*c:0;c=h?l.left-m:l.right+m;var k=l.top+m,n=a.B.Os();a=qh(a.B.zL,b);var q=Kz(BA(e,b));n||a||!q?(b=k+125,0<b-f.NQ()&&(e=e.In("r")-1,f.BQ(b,"waffle")>=e&&(k-=50))):(a=RI(d),n=a.K,I4a(d,EA(e,b).Yd()),e=a.R.height?a.fc:0,b=a.V.height,d=Math.min(UTa.height,e+b),b&&(d=d+30+12,d+=EE.top,d+=EE.bottom),e&&(d+=12,d+=EE.top,d+=EE.bottom),e=d,ED(a,n),k+=e);l=h?l.right+m+212:l.left-m-212;m=h?0>c-212:c+212>f.nJ();e=h?l>f.nJ():
0>l;m&&!e&&(c=l);return new N(h?f.lp(c,"c"):c,k)}function u3b(a,b){var c=u0(a.C,a.K,b),d=Nu(a.C);return!!c&&c==d}function B3b(a,b){if(!b)return!1;var c=uTb(Wx(a.F)),d=!1,e=b.Yd();Lga(b,function(a,b){var k;if(k=a==e.y)k=null!=oG(c,new N(b,a));return k?d=!0:!1});return d}r.uqb=function(){e3b(this)};function e3b(a){var b=Wx(a.F);b&&(a.Y.appendChild(b.hH,a.J),a.D.setOption(Docos.OptionName.LAYOUT_RTL,b.B.Rb()),a.D.setOption(Docos.OptionName.ANCHOR_DIV,a.J),a.D.B.renderAnchorSurface())}
function q3b(a,b){var c,d=a.J.style;c="";"opacity"in d?c=d.opacity:"MozOpacity"in d?c=d.MozOpacity:"filter"in d&&(d=d.filter.match(/alpha\(opacity=([\d.]+)\)/))&&(c=String(d[1]/100));c=""==c?c:+c;c=ra(c)?1:c;Io(a.J)||(c=0);d=b&&1>c?"in":!b&&0<c?"out":"none";"none"==d?(J(a.ju),R(a.J,b)):a.ju&&1==a.ju.Ea&&a.U8==d||(J(a.ju),R(a.J,!0),a.ju=new dt(a.J,c,"in"==d?1:0,250),a.U8=d,"out"==d&&Df(a.ju,"finish",v(a.T_a,a)),a.ju.play())}r.T_a=function(){A0(this);var a=Wx(this.F);a&&iD(a)};
r.T=function(){delete this.F;delete this.J;delete this.M;delete this.D;delete this.G;delete this.B;delete this.P;delete this.Y;delete this.U8;delete this.K;delete this.C;delete this.Ka;J(this.ju);delete this.ju;n3b(this);m3b(this);o3b(this);J(this.xa);delete this.xa;d3b.O.T.call(this)};function C3b(a,b,c,d,e,f){H.call(this);this.M=a;this.R=u(b)?b:!0;this.P=u(c)?c:1;this.D=new EQ(v(this.nPa,this),d||1E3,e||6E4,f);I(this,this.D);this.G=new Xi(void 0,this);this.B=null;this.J=[];this.F="DCS_Callback"+String(D3b++);this.K=this.C=null}y(C3b,H);var D3b=0;r=C3b.prototype;r.d8=function(){this.B=null;this.D.stop();this.G.Cb(this.J)};
r.dqa=function(a){a instanceof Yi||(a instanceof ZR&&3==a.code?this.d8():(this.B=null,this.J.push(a instanceof Error?a.message:""),0<this.P--?this.D.start():this.G.Bd(this.J)))};r.Dcb=function(){this.D.Kb()||this.D.start();var a=new Xi;bj(this.G,a);return a};
r.nPa=function(){if(this.R){this.C=new oW(this.M);this.C.Sg=1E4;var a=v(this.d8,this);fa(this.F,a,void 0);this.K=this.C.send({callback:this.F},void 0,v(this.dqa,this))}else this.B&&this.B.cancel(),this.B=aUb(this.M,"dcs_main_js",{timeout:1E4}),Zi(this.B,this.d8,this.dqa,this)};r.T=function(){this.B&&this.B.cancel();this.G.cancel();ea[this.F]&&(ea[this.F]=ia);this.C&&this.K&&this.C.cancel(this.K);C3b.O.T.call(this)};function E3b(){var a;a=""+('<div class="docs-docos-activitybox" role="dialog" aria-label="'+Hq("Comment stream box.")+'"><div class="docs-docos-activitybox-inner"></div></div>');return qq(a)};function B0(a,b){S.call(this,b);this.B=a}y(B0,S);r=B0.prototype;r.c8=null;r.WO=null;r.FP=null;r.Xm=null;r.Fna=!1;r.Na=function(){B0.O.Na.call(this);var a=this.Z(),b=hq(E3b,{},{},a);this.oa=b;bm(b,!0);this.WO=a.getElement("docs-docos-caret");this.c8=a.Od("docs-docos-activitybox-inner",b);this.B&&(go(b,"docos-enable-new-header"),go(this.WO,"docos-enable-new-header"))};
r.Fa=function(){this.FP=new un(this.getElement());this.FP.Ak("close-box",27);this.Xm=new gp(this.getElement(),"toggle_display");hp(this.Xm,!0);var a=this.Xm;xsa(a);a.pba=!1;this.Xm.$qa=!1;W(this).L(this.FP,"shortcut",this.M8a).L(this.Xm,"show",this.mfb).L(this.Xm,"hide",this.lfb).L(this.Xm,"beforeshow",this.kfb).L(this.Xm,"beforehide",this.jfb)};r.Db=g("c8");r.mfb=function(){R(this.WO,!0);this.dispatchEvent("show")};r.lfb=function(){R(this.WO,!1)};r.kfb=function(){return this.dispatchEvent("beforeshow")};
r.jfb=function(){return this.Fna?!1:this.dispatchEvent("hide")};r.setVisible=function(a){this.Xm.setVisible(a)};r.Oa=function(){return!!this.Xm&&this.Xm.Oa()};r.M8a=function(a){switch(a.B){case "close-box":this.setVisible(!1)}};r.T=function(){J(this.FP);delete this.FP;delete this.WO;delete this.c8;J(this.Xm);delete this.Xm;B0.O.T.call(this)};function F3b(a,b,c,d){L.call(this);this.D=c||new zl;this.B=a;this.M=!!b;this.C=new B0(this.B.isDocsStreamHeaderEnabled&&this.B.isDocsStreamHeaderEnabled(),this.D);this.U=new M(this);this.G=new Os(void 0,void 0,!0,Ys.getInstance());this.F=d||Q.zia;this.J=!1;this.K=Jf(Lf(),"docs-edll");this.B.onReady(v(this.rfb,this))}y(F3b,L);r=F3b.prototype;r.nz=null;r.Dxa=!1;r.render=ba();
r.rfb=function(){var a=this.D.getElement("docs-docos-commentsbutton");this.nz=bY(null);Op(this.nz,16);this.nz.Pa(a);Jf(Lf(),"docosUnreadCommentsEnabled")&&(this.B.setListener(Docos.EventType.UNREAD_COMMENTS,this.Qfb,this),this.B.setOption(Docos.OptionName.ENABLE_UNREAD_COMMENTS,!0),Q.Ev.Hc(Qm,this.aLa,this));Ts(this.G,this.nz,Q.Ev,Us);Q.Ev.Hc(Qm,this.rjb,this);this.C.render(a.parentNode.parentNode);R(this.C.getElement(),!1);Q.Ev.Da(!0);this.B.setOption(Docos.OptionName.PANE_DIV,this.C.Db());this.B.setOption(Docos.OptionName.PANE_KB_DIV,
this.C.getElement());this.B.setOption(Docos.OptionName.ENABLE_LAZY_LOADING,this.K);var b;this.K?(b=this.B.getLinkedDoco(),b=!!b&&(!this.B.hasDoco(b)||this.B.isDocoResolved(b)||!this.B.getDocoPosition(b))):b=!0;b?(this.B.renderPaneSurface(),this.J=!0):this.B.isLinkedDocoDeleted()&&(b=Uq("This comment has been deleted.","info",!0),Sq.getInstance().postMessage(b));this.B.setListener(Docos.OptionName.DIALOG_OPENED,v(this.RAa,this));this.B.setListener(Docos.OptionName.DIALOG_CLOSED,v(this.RAa,this));this.B.setOption(Docos.OptionName.SORT_PANE,
!0);this.B.setOption(Docos.OptionName.STREAM_BUTTON,a);Docos.EventType.CREATE_DRAFT&&(this.B.setListener(Docos.EventType.CREATE_DRAFT,this.HNa,this),this.F.Hc(Om,this.QAa,this),this.QAa(new Ioa("enabled",this.F.isEnabled(),!1)));this.M||this.B.setListener(Docos.EventType.NETWORK_ERROR,this.ffb,this);this.U.L(this.C,["show","hide"],this.Qdb)};r.RAa=function(a){a=a.args.shouldOverrideHide()&&a.type==Docos.OptionName.DIALOG_OPENED;this.C.Fna=a};
r.QAa=function(a){this.B.setOption(Docos.OptionName.ENABLE_COMMENT_BUTTON,a.newValue)};r.HNa=function(a){this.C.setVisible(!1);var b=a.args.isInstantDoco()?Q.jIa:this.F,c;if(a.args.isInstantDoco()){c=new Sm;var d=-1==a.args.getInstantDocoSpacerIndex();P(c,42,d?K2b.YJa:K2b.HOVER);c=zn(An(new yn,c),31).Aa()}b.$b(a.args,c)};r.rjb=function(){this.J||(this.B.renderPaneSurface(),this.J=!0);var a=this.C;a.Xm&&!ysa(a.Xm)&&a.Xm.setVisible(!0)};
function G3b(a,b){if(0>b)throw Error("Number of unread comments cannot be negative");Jp(a.nz,"docs-docos-commentsbutton-unread",0<b);var c=a.D.getElement("docs-docos-commentsbutton");a.D.xg(c,String(b))}r.Qfb=function(){var a=this.B.getUnreadCommentsCount();G3b(this,a)};r.aLa=function(){G3b(this,0);this.B.ackUnreadComments()};
r.ffb=function(){if(!this.Dxa&&Q.Ii.isEnabled()){if(this.B.hasPendingContent()){var a=Uq("Failed to post comment due to a network error.","warning",!0);Sq.getInstance().postMessage(a)}this.B.setOption(Docos.OptionName.FATAL_READONLY,!0);this.B.setOption(Docos.OptionName.SHOW_ERRORS,!0);Q.zia.Da(!1,"docos-fatal-reason");this.Dxa=!0}};r.Qdb=function(a){a="show"==a.type;this.B.isPaneSurfaceRendered()&&this.B.setOption(Docos.OptionName.SORT_PANE,!a);this.nz.yc(a);a?this.B.grabFocus():this.dispatchEvent("activity-box-closed")};
r.T=function(){J(this.nz);delete this.nz;J(this.U);delete this.U;J(this.C);delete this.C;J(this.G);delete this.G;delete this.B;F3b.O.T.call(this)};function H3b(){H.call(this)}y(H3b,qm);r=H3b.prototype;r.ySa=function(){return C3b};r.TSa=function(){return F3b};r.QSa=function(){return V2b};r.RSa=function(){return b3b};r.SSa=function(){return d3b};ym("docos",H3b);
