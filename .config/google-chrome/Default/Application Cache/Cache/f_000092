function SEc(a,b,c){b=wb(a,b.equals,b);0<=b&&b!=c&&(b=Cb(a,b,1),Cb(a,c,0,b[0]))}function J$(a,b){E(a,1,b)}tIa.prototype.Nw=aS(84,function(a){var b=C(this.C,1),c=!sc(b,3)||!sc(b,4),d=!sc(b,1)||!sc(b,2),e=d?0:zc(b,1),f=a?Zu(a):0,f=d?f:zc(b,2),h=c?0:zc(b,3);a=a?a.kf():0;b=c?a:zc(b,4);return new Ch(e,h,f,b,c,d)});je.prototype.TI=aS(18,function(){return C(this,5)});tIa.prototype.TI=aS(17,g("D"));fe.prototype.Km=aS(16,function(){return zc(this,1)});he.prototype.Km=aS(15,function(){return zc(this,1)});
ne.prototype.Km=aS(14,function(){return zc(this,1)});pd.prototype.getRelativityIndicatorsId=aS(8,function(){return C(this,5)});function TEc(a,b){var c=new zg(b);a.B.dg(function(a){a.yc(c.contains(a.Ba()))})}function UEc(a,b){var c=uIa.Mc((new je).ma(),b);return CIa(c,a.ym,a.B,a.Er)}function VEc(a,b,c){function d(a){if(sc(a,7)){var b=Math.min(e,c),d=Math.max(e,c);a=C(a,7);var l=C(a,1);l==e?J$(a,c):l>=b&&l<=d&&(e>c?J$(a,l+1):e<c&&J$(a,l-1))}}var e=nb(a.zp,b);SEc(a.zp,b,c);A(a.dn,d);A(a.Gm,d)}
function WEc(a,b){function c(a){if(sc(a,7)){var c=C(a,7),f=C(c,1);f==b?vc(a,7):f>b&&J$(c,f-1)}}Fb(a.zp,b);A(a.dn,c);A(a.Gm,c)}function XEc(a){return a.zp}function YEc(a,b,c){null!=c?(Bb(a.zp,b,c),b=function(a){if(sc(a,7)){a=C(a,7);var b=C(a,1);b>=c&&J$(a,b+1)}},A(a.dn,b),A(a.Gm,b)):a.zp.push(b)}
function ZEc(a,b){var c=0,d=0,e=new pd;b.Id||(c=b.Ob(),E(e,1,c),c=b.mc(),E(e,2,c),c=2);b.Gd()||(d=b.Fb(),E(e,3,d),d=b.zc(),E(e,4,d),d=2);c=ritz.getRelativityIndicatorsId(c,c,d,d,!0);E(e,5,c);E(e,6,""+a);c=new od;E(c,2,0);E(c,1,e);return c}function $Ec(a,b){E(a,3,b)}function aFc(a){return zc(a,3)}function bFc(a,b){E(a,2,b)}function K$(a){return C(a,4)}function cFc(a,b){E(a,8,b)}function dFc(a){return zc(a,8)}function eFc(a,b){E(a,2,b)}function fFc(a,b){E(a,3,b)}function gFc(a){return yc(a,2)}
function hFc(a){return C(a,2)}function iFc(a,b){var c=/\d+|\.\d+|\D+/g;if(a==b)return 0;if(!a)return-1;if(!b)return 1;for(var d=a.toLowerCase().match(c),e=b.toLowerCase().match(c),f=Math.min(d.length,e.length),h=0;h<f;h++){var c=d[h],k=e[h];if(c!=k)return d=parseInt(c,10),!isNaN(d)&&(e=parseInt(k,10),!isNaN(e)&&d-e)?d-e:c<k?-1:1}return d.length!=e.length?d.length-e.length:a<b?-1:1}var jFc={XKa:"waffle-pivot-zippy-expanded",WKa:"waffle-pivot-zippy-collapsed"};
function kFc(a,b,c){var d=b.Ob();b=b.Fb();a=a?a.ad(d,b+c).getDisplayValue():"";""==a&&(a="Column "+Vu(b+c));return a}function lFc(){var a=new Dr;a.gc=p("goog-menu waffle-pivot-add-field-menu");return a}function mFc(a,b,c){b=Array.prototype.splice.call(a,b,1);Array.prototype.splice.call(a,c,0,b[0])}function nFc(a,b){return iFc(a,b)}function oFc(a,b){TC.call(this,1602,b);this.C=a}y(oFc,TC);oFc.prototype.Qd=p(47);oFc.prototype.Nd=function(){var a=new $v,b=DIa(this.C);E(a,1,b);return a};function L$(a,b){K.call(this,a,b)}y(L$,K);function pFc(a){a=a||{};a=""+Gq(mY(Aq(a,{title:Cq("Report Editor"),jj:Dq('<div id="waffle-pivot-pane"><div id="waffle-pivot-range-selection"><div class="input-selection-button goog-inline-block"></div><span class="waffle-pivot-label-text waffle-pivot-range-span" id="waffle-pivot-range-text"></span><span class="waffle-pivot-label-text waffle-pivot-range-span">&nbsp;-&nbsp;</span>'+Gq(kr({Vd:"goog-inline-block waffle-pivot-label-button",content:Dq("Edit range..."),id:"waffle-pivot-range-selection-button",
style:4}))+'</div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+qFc({Fw:Cq("Rows"),id:"waffle-pivot-add-field-row"})+'</div><div id="waffle-pivot-row-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+qFc({Fw:Cq("Columns"),id:"waffle-pivot-add-field-column"})+'</div><div id="waffle-pivot-column-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+
qFc({Fw:Cq("Values"),id:"waffle-pivot-add-field-value"})+'<div id="waffle-pivot-aggr"><span id="waffle-pivot-aggr-label" class="waffle-pivot-label-text">as:&nbsp;</span><div id="waffle-pivot-aggr-select"></div></div></div><div id="waffle-pivot-values" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+qFc({Fw:Cq("Filter"),id:"waffle-pivot-add-field-filter"})+'</div><div id="waffle-pivot-filter" class="waffle-pivot-drop-target"></div></div><div id="waffle-pivot-button-container"><label><input type="radio" name="autoupdate" value="autoupdate" checked id="waffle-pivot-update-auto" />Update table on each change</label><br /><label><input type="radio" name="autoupdate" value="manual" id="waffle-pivot-update-manual"/>Manually</label><button id="waffle-pivot-button-update" disabled="true">Update table</button><br /></div></div>')})));
return qq(a)}function qFc(a){var b;b=""+('<strong id="'+Y(a.id)+'-field-label">'+X(a.Fw)+'</strong><span class="waffle-pivot-label-text">&nbsp;-&nbsp;</span>');var c;c=Cq("Add field");b+=Gq(kr({Vd:"goog-inline-block waffle-pivot-label-button",content:c,attributes:Eq('aria-label="'+Y(a.Fw)+" "+Y(c)+'"'),id:a.id,style:4}));return qq(b)}
function rFc(a){return qq('<div class="waffle-pivot-pill" role="group" tabindex="0"><table class="waffle-pivot-pill-main-table" role="presentation"><tbody><tr><td class="waffle-pivot-pill-main-table-text"><strong>'+X(a.jpa)+'&nbsp;</strong><span class="waffle-pivot-pill-title"></span></td><td class="waffle-pivot-pill-main-table-fill"><div class="waffle-pivot-pill-draghandle"></div></td><td class="waffle-pivot-pill-close waffle-pivot-pill-nodrag"></td></tr></tbody></table></div>')};function M$(a,b,c,d,e,f){S.call(this,f);this.M=a;this.Y=c;this.R=d;this.P=e;this.Gf(b)}y(M$,S);r=M$.prototype;r.Na=function(){this.oa=hq(rFc,{jpa:this.M})};r.Fa=function(){M$.O.Fa.call(this);var a=this.Z(),b=W(this);this.J=im(a,"span","waffle-pivot-pill-title",this.getElement())[0];var c;c=new lr("\u2715",a,4);c.render(im(a,"td","waffle-pivot-pill-close",this.getElement())[0]);ao(c.getElement(),"Close edit field and remove from pivot table");I(this,c);b.L(c,"action",this.uob)};
r.gx=function(){var a=new L$("pivot-pill-changed",this);a.B=this;this.dispatchEvent(a)};function N$(a,b){a.J&&(a.Z().xg(a.J,b),ao(a.getElement(),"Edit field: "+(a.M+(" "+(b+".")))),a.J.title=b)}function sFc(a){return a.Z().sJ(a.J)}function O$(a,b){return kFc(a.vc(),a.P,b)}function P$(a,b,c){a=a.Z();return a.qa("span",c,lm(a,b+"\u00a0"))}function Q$(a){return a.Z().qa("div","waffle-pivot-pill-nodrag")}
r.vH=function(a){var b=this.Z(),c=b.qa("div","waffle-pivot-pill-section",arguments);1<Tl(this.getElement()).length&&go(c,"waffle-pivot-pill-section-top-border");b.appendChild(this.getElement(),c)};r.bw=function(a){W(this).L(a.getElement(),"mouseover",this.P_).L(a.getElement(),"mouseout",this.P_)};r.P_=function(a){a=a.target;var b=!co(a,"waffle-pivot-select-hover");ko(a,"waffle-pivot-select-hover",b)};r.Nw=g("P");r.vc=function(){var a=xz(this.Y.B,this.R);return a?a.vc():null};
r.uob=function(){var a=new L$("pivot-remove-pill",this);a.B=this;this.dispatchEvent(a)};r.Yna=p(!0);r.DDa=ia;function R$(){}y(R$,Ir);ja(R$);R$.prototype.gc=p("waffle-pivot-select");R$.prototype.cI=function(a){return a.qa("div","goog-inline-block "+(this.gc()+"-dropdown"),"\u00a0\u25be")};function S$(a,b,c,d,e){M$.call(this,"Filter:",a,b,c,d,e);this.B=new bs("",null,R$.getInstance(),e);I(this,this.B)}y(S$,M$);r=S$.prototype;r.Fa=function(){S$.O.Fa.call(this);N$(this,O$(this,tFc(this)));var a=P$(this,"Show:"),b=Q$(this);this.B.Pa(b);this.B.Ru=!0;this.B.zJ("Loading...");ao(this.B.oa,"Show:");var c=new T$;I(this,c);this.B.Cf(c);this.bw(this.B);this.vH(a,b)};r.Gf=function(a){S$.O.Gf.call(this,a);N$(this,O$(this,tFc(this)))};function tFc(a){return a.Ga().Pg()-a.Nw().Fb()}
function U$(a){return a.B.dc().B}r.bw=function(a){S$.O.bw.call(this,a);W(this).L(U$(this),"filters_selected",this.d0a).L(U$(this),"filtering_cancelled",this.e0a)};function uFc(a,b,c){var d=[];if(!c)return d;a=b.Fb()+a;var e=Mh(b,"r");for(b=b.Ob()+1;b<e.end;b++){var f=c.ad(b,a);Sb(d,f.getDisplayValue(),nFc)}return d}function vFc(a){var b=U$(a),c=gFc(hFc(a.Ga())),d=new zg(c),e=sb(b.getFilterChoices(),function(a,b){return d.contains(b)?a-1:a},b.getFilterChoices().length);TEc(b,c);wFc(a,e)}
function wFc(a,b){var c=U$(a);0==b?a.B.zJ("All items"):(c=c.getFilterChoices().length-b,a.B.zJ(null!=c?""+c+" items":"All items"))}r.d0a=function(a){this.B.Td(!1);wFc(this,a.Ha.length);this.gx()};r.e0a=function(){this.B.Td(!1);var a=this.B.oa;try{ef&&this.Z().tb().body.focus(),a.focus()}catch(b){}vFc(this)};function T$(a){Fr.call(this,a);this.B=new XX([],!1,null,a)}y(T$,Fr);T$.prototype.Fa=function(){T$.O.Fa.call(this);this.B.render(this.Db());var a=new nt(this.B.oa,this.Z());ot(a);I(this,a)};
T$.prototype.VQ=function(a){Wl(a.target)&&this.B.Oj(a.target)||T$.O.VQ.call(this,a)};function V$(a,b,c,d,e,f){M$.call(this,"Group by:",a,b,c,d,f);this.V=e}y(V$,M$);r=V$.prototype;
r.Fa=function(){V$.O.Fa.call(this);var a=this.Ga();N$(this,O$(this,a.Km()));var b=this.Z(),a=P$(this,"Order:"),c=Q$(this),d=new Fr;d.Ja(new Sp(b.aj("Ascending"),0),!0);d.Ja(new Sp(b.aj("Descending"),1),!0);b=this.D=new bs("",d,R$.getInstance(),b);b.Pa(c);b.Ma(dFc(this.Ga()));ao(b.getElement(),"Order:");this.bw(b);this.vH(a,c);var b=this.Z(),c=P$(this,"Sort by:"),a=Q$(this),d=new Fr,e=O$(this,this.Ga().Km());d.Ja(new Sp(e,-1),!0);d=this.K=new bs("",d,R$.getInstance(),b);d.Pa(a);ao(d.getElement(),"Sort by:");
W(this).L(d.getElement(),"mouseover",this.P_).L(d.getElement(),"mouseout",this.P_).L(d,"action",this.bSa);b=v(b.qa,b,"div",["goog-inline-block","waffle-pivot-pill-sort-by"]);c=b(c);this.G=b(a);this.vH(c,this.G);a=this.Ga();a=zc(a,2);c=P$(this,"Show totals","waffle-pivot-pill-align-middle waffle-pivot-pill-nodrag");b=Q$(this);go(b,"goog-inline-block");this.C=new Oq;lq(this.C,c);this.C.yc(a);this.C.render(b);W(this).L(this.C,"change",this.gx);this.vH(b,c)};
r.Gf=function(a){V$.O.Gf.call(this,a);N$(this,O$(this,a.Km()));this.C&&this.C.yc(zc(a,2));this.D&&this.D.Ma(dFc(a));xFc(this)};r.Gd=g("V");r.bSa=function(a){a=new L$("pivot-sort-by-change",a.currentTarget);a.B=this;this.dispatchEvent(a)};r.cSa=function(a){a=new L$("pivot-sort-key-change",a.currentTarget);a.B=this;this.dispatchEvent(a)};function yFc(a){var b=[];if(a.B)for(var c=a.B.Bc(),d=0;d<c;d++)0<=a.B.Jc(d).Ba()&&b.push(a.B.Jc(d).zk());return b}
function zFc(a){if(!a.B){var b=a.Z(),c=Q$(a);go(c,"waffle-pivot-multi-select");a.B=new sr("horizontal",null,b);a.B.Pa(c);b.appendChild(a.G,c)}}function xFc(a){if(a.B)for(J(a.B),a.B=null;1<a.G.children.length;)Rl(a.G.lastElementChild)}r.bw=function(a){V$.O.bw.call(this,a);W(this).L(a,"hide",this.gx)};r.T=function(){V$.O.T.call(this);J(this.D);J(this.K);J(this.B);J(this.C);this.G=null};function AFc(){L.call(this);this.C="";this.B=!1}y(AFc,L);AFc.prototype.Ba=g("C");AFc.prototype.Ma=function(a){this.C=a;this.B=!0;this.dispatchEvent("change")};function W$(a,b,c,d,e){M$.call(this,"Display:",a,b,c,d,e);this.D=this.G=this.B=null;this.C=0}y(W$,M$);var BFc="SUM COUNTA COUNT COUNTUNIQUE AVERAGE MAX MIN MEDIAN PRODUCT STDEV STDEVP VAR VARP".split(" "),CFc=["SUM"];r=W$.prototype;r.Fa=function(){W$.O.Fa.call(this);N$(this,DFc(this));EFc(this)};
function EFc(a){var b=a.Ga();if(1==K$(b)){var c=new Fr;A(BFc,function(a){c.Ja(new Sp(a),!0)});a.B=FFc(a,c,C(b,5).Nz())}else{var d=C(b,6);a.D=GFc(a,"Name",zc(b,3));a.G=GFc(a,"Formula",aFc(d)||"=");c=new Fr;A(CFc,function(a){c.Ja(new Sp(a),!0)});c.Ja(new Sp("Custom","CUSTOM"),!0);a.B=FFc(a,c,HFc(a));W(a).L(a.B,"hide",v(a.QWa,a))}}
function FFc(a,b,c){var d=a.Z(),e=P$(a,"Summarize by:"),f=Q$(a);b=new bs("",b,R$.getInstance(),d);I(a,b);b.Pa(f);b.Ma(c);ao(b.oa,"Summarize by:");a.bw(b);a.vH(e,f);return b}function GFc(a,b,c){var d=a.Z(),e=P$(a,b),f=Q$(a);b=new MS(b,d);I(a,b);b.render(f);b.Ma(c);a.vH(e,f);c=new Yp(b.oa);I(a,c);e=new Wo(b.oa);I(a,e);W(a).L(c,"input",a.r2a).L(e,"focusout",a.q2a);return b}r.Ba=function(){return this.G?this.G.Ba():this.B.Ba()};function IFc(a){a=a.B.Ba();return"CUSTOM"==a?null:a}
r.bw=function(a){W$.O.bw.call(this,a);W(this).L(a,"hide",this.gx)};r.QWa=function(){Z.Gka.$b()};r.Gf=function(a){var b=K$(a);null!=this.Ga()&&K$(this.Ga());W$.O.Gf.call(this,a);N$(this,DFc(this));1==b?null!=this.B&&this.B.Ma(C(a,5).Nz()):null!=this.D&&null!=this.G&&(sc(a,3)&&this.D.Ma(zc(a,3)),this.G.Ma(aFc(C(a,6))||"="),this.B.Ma(HFc(this)))};function DFc(a){var b=a.Ga();return sc(b,3)&&zc(b,3)?zc(b,3):1==K$(b)?O$(a,C(b,5).Km()):"Calculated Field"}
r.r2a=function(){this.C&&(clearTimeout(this.C),this.C=0);this.C=setTimeout(v(function(){this.gx();this.C=0},this),3E3)};r.q2a=function(){this.C&&(clearTimeout(this.C),this.C=0);this.gx()};function HFc(a){a=a.Ga();a=C(a,6);a=C(a,4);return null!=a?a:"CUSTOM"}r.Yna=function(){return 1==K$(this.Ga())};r.T=function(){W$.O.T.call(this);J(this.B)};r.DDa=function(){2==K$(this.Ga())&&this.D.getElement().focus()};function X$(a,b,c,d,e){hY.call(this,e);a=this.Z();var f=JFc,h=KFc;this.ib=b;this.Zb=c;this.D=d;this.C={};this.J=!0;this.xb=null;this.V=new AFc;this.La=new M(this);this.Qa=new kY;this.Ca=[];this.Sa=this.G=null;this.Va=new Sp("No fields left to add",void 0,e);this.Va.Da(!1);this.K=this.M=null;this.Ia=pc(f.dHa,h.FW,f.bHa,h.XM,f.cHa,h.Hla,f.aHa,h.eia);this.P=this.Y=null;b=new Fr(a);b.Ja(new Sp("Columns",2,a),!0);b.Ja(new Sp("Rows",1,a),!0);this.R=new bs("",b,R$.getInstance(),a)}y(X$,hY);
var JFc={FW:"waffle-pivot-values",XM:"waffle-pivot-filter",LHa:"waffle-pivot-column-label",WJa:"waffle-pivot-row-label",dHa:"waffle-pivot-add-field-value",bHa:"waffle-pivot-add-field-filter",cHa:"waffle-pivot-add-field-row",aHa:"waffle-pivot-add-field-column",gHa:"waffle-pivot-aggr-select",hHa:"waffle-pivot-aggr",ptb:"waffle-pivot-apply",zHa:"waffle-pivot-button-container",KMb:"waffle-pivot-range-selection",LMb:"waffle-pivot-range-selection-button",MMb:"waffle-pivot-range-text",Ema:"waffle-pivot-button-update",
LKa:"waffle-pivot-update-auto",MKa:"waffle-pivot-update-manual"},KFc={Hla:"row-breakout",eia:"col-breakout",XM:"filter",FW:"aggregation"};r=X$.prototype;r.Na=function(){this.oa=hq(pFc,{id:this.getId()})};
r.Fa=function(){function a(a,b){f.L(Bl(a),"click",b)}X$.O.Fa.call(this);var b=this.Z(),c=JFc;R(b.getElement(c.zHa),!1);var d=KFc;this.K=pc(d.FW,b.getElement(c.FW),d.XM,b.getElement(c.XM),d.Hla,b.getElement(c.WJa),d.eia,b.getElement(c.LHa));this.xb=b.getElement(c.Ema);var d=Ep(HD,""),e=lFc(),f=W(this),h;for(h in this.Ia){var k=new Jr("",new Fr(b,e),d,b);I(this,k);k.Pa(b.getElement(h));f.L(k,"show",this.IVa).L(k.dc(),"action",this.HVa)}a(c.Ema,this.u$a);a(c.LKa,this.ova);a(c.MKa,this.ova);this.P=b.getElement(c.hHa);
R(this.P,!1);this.R.Pa(b.getElement(c.gHa));f.L(this.R,"action",this.ZVa);this.Sa=new Wo(this.Db());f.L(this.Sa,"focusin",this.Eob).L(this.Sa,"focusout",this.Fob);LFc(this)};r.Eob=function(a){this.G=MFc(this,a.target)};r.Fob=function(a){if(a=a.relatedTarget){var b=this.Db();fm(a,function(a){return a==b})||(this.G=null)}};
function MFc(a,b){if(!b)return null;var c=a.Z().vSa(b,"waffle-pivot-pill");if(!c)return null;var d=null,e=null;Yb(a.C,function(a,b){return(d=vb(a,function(a){return a.getElement()==c}))?(e=b,!0):!1});return d?{container:e,label:sFc(d)}:null}
function NFc(a){var b=a.Z();if(a.G){var c=a.G.container,d=a.C[c];if(d&&a.G.label)for(var e=0,f;f=d[e];e++)if(sFc(f)==a.G.label){OFc(a,f.getElement());return}d&&0<d.length?OFc(a,d[d.length-1].getElement()):(d=ec(a.Ia,function(a){return a==c}),OFc(a,b.getElement(d)))}}
r.Gf=function(a){X$.O.Gf.call(this,a);a?(PFc(this,function(){function b(a,b){if(a)for(;a.length>b;)J(a.pop())}function c(b,c,d){var k="row-breakout"==b;this.C[b]&&this.C[b][d]?(d=this.C[b][d],d.Gf(c),b=new L$("pivot-pill-model-updated"),b.B=d,this.dispatchEvent(b)):(d=new V$(c,this.D,a.ym,Y$(this),k,this.Z()),d.render(),QFc(this,d,b))}var d=a.Er,d=ritz.renderPivotTableCalculatedFieldFormulas(a.O9(),d);a=UEc(a,d);A(a.hs,function(b,c){if(this.C.filter&&this.C.filter[c]){var d=this.C.filter[c];d.Gf(b)}else d=
new S$(b,this.D,a.ym,Y$(this),this.Z()),d.render(),QFc(this,d,"filter")},this);A(a.dn,xa(c,"row-breakout"),this);A(a.Gm,xa(c,"col-breakout"),this);A(a.zp,function(b,c){var d=null;this.C.aggregation&&this.C.aggregation[c]&&(d=this.C.aggregation[c]);if(d&&d.Ga()&&K$(d.Ga())==K$(b))d.Gf(b);else{var k=new W$(b,this.D,a.ym,Y$(this),this.Z());k.render();d?RFc(this,d,k,"aggregation"):QFc(this,k,"aggregation")}},this);b(this.C["row-breakout"],a.dn.length);b(this.C["col-breakout"],a.Gm.length);b(this.C.filter,
a.hs.length);b(this.C.aggregation,a.zp.length);d=(d=(d=xz(this.D.B,a.ym))?d.B:null)?dv(a.Nw(SFc(this)),d):"#REF!";TFc(this,d);this.V.Ma(d);(d=this.C.aggregation)&&2<=d.length?(R(this.P,!0),this.R.Ma(a.TI())):R(this.P,!1)}),X$.O.Gf.call(this,a),UFc(this,function(){var a=this.C.filter;a&&A(a,function(a){var b=U$(a),e;e=uFc(tFc(a),a.Nw(),a.vc());LTb(b,e);vFc(a)},this)})):this.reset()};r.focus=function(){X$.O.focus.call(this);OFc(this,Dl("waffle-sidebar-title",this.getElement()))};
function QFc(a,b,c){a.K[c].appendChild(b.getElement());a.C[c]||(a.C[c]=[]);a.C[c].push(b);b.Lc(a);VFc(a,b);LFc(a)}function RFc(a,b,c,d){a.Z().oL(c.getElement(),b.getElement());d=a.C[d];var e=nb(d,b);Cb(d,e,1,c);J(b);c.Lc(a);VFc(a,c);LFc(a)}function VFc(a,b){W(a).L(b,"pivot-remove-pill",a.Hob).L(b,"pivot-pill-changed",a.Gob).L(b.getElement(),"keydown",a.h2a);var c=new L$("pivot-pill-created");c.B=b;a.dispatchEvent(c)}
function LFc(a){a.La.Wb();J(a.Qa);var b=a.Qa=new kY;Vb(a.K,function(a){iUb(b,a)});b.De();a.La.L(b,"beforedragstart",a.Bob).L(b,"dragstart",a.Dob).L(b,"dragend",a.Cob)}r.reset=function(){Vb(this.C,function(a){A(a,J)});this.C={}};function TFc(a,b){var c=a.Z();c.xg(c.getElement("waffle-pivot-range-text"),b)}
r.Hob=function(a){var b=new L$("pivot-pill-removed",this);b.B=a.target;b.container=ec(this.C,function(b){return xb(b,a.target)});b.Ka=WFc(this,b.container,a.target);b.container&&(Eb(this.C[b.container],a.target),this.G={container:b.container,label:null},this.dispatchEvent(b))};r.Gob=function(a){a.container=ec(this.C,function(b){return xb(b,a.target)})};r.h2a=function(a){!a.shiftKey||38!=a.keyCode&&40!=a.keyCode||XFc(this,a.target,38==a.keyCode)};
function XFc(a,b,c){var d=null,e=-1;Yb(a.K,function(a,c){e=nb(a.childNodes,b);return 0<=e?(d=c,!0):!1});var f=a.C[d];if(!(!f||1>=f.length||(c=c?e-1:e+1,0>c||c>f.length-1))){mFc(f,e,c);var h=new L$("pivot-pill-changed",a);h.B=f[c];h.container=d;h.D=d;h.position=c;h.V=!0;a.dispatchEvent(h)}}r.u$a=function(){this.dispatchEvent("pivot-table-update")};r.ova=function(a){a=this.J="autoupdate"==a.target.value;(this.xb.disabled=a)&&this.dispatchEvent("pivot-table-update")};r.ZVa=function(){this.dispatchEvent("pivot-aggregation-orientation-changed")};
r.TI=function(){return this.R.Ba()};function YFc(a,b,c,d){Ff(a.M);wTb(a.ib,a.V,a.V.Ba(),!1,!1,!0,v(a.Vjb,a,b,c,!!d))}r.Vjb=function(a,b,c,d){var e=this.V,f=this.D;e.B=!1;var h=e.Ba();this.M=Df(d,"afterhide",function(){if(e.B){var d=bv(e.Ba(),f.B,!0,!0);d?a(d):(e.Ma(h),b())}else b();c||OFc(this,Bl("waffle-pivot-range-selection-button"))},!1,this)};
r.IVa=function(a){var b=a.target.getParent(),c=b.dc();this.Y=this.Ia[b.oa.id];PFc(this,function(){var a=this.Y,e=SFc(this),f=Y$(this),h=ZFc(this,a);c.Kd(!0);for(var k=Mh(f,"c"),l=0,m=k.start;m<k.end;m++){var n=kFc(e,f,l);n&&!h[n]&&c.Ja(new Sp(n,l),!0);l++}"aggregation"==a&&(c.Ja(new Er,!0),c.Ja(new Sp("Calculated Field",-1),!0));0==c.Bc()&&c.Ja(this.Va,!0);gS(b,!0);b.Gx();gS(b,!1)})};function OFc(a,b){try{ef&&a.Z().tb().body.focus(),b.focus(),a.Zb.qc(2)}catch(c){}}
r.HVa=function(a){var b=this.Y;a=a.target.Ba();var c=new L$("pivot-pill-added",this);c.container=b;c.K=a;this.G={container:b,label:null};this.dispatchEvent(c)};r.Bob=function(a){for(var b=a.event.target||a.event.B.target;b instanceof Element&&!co(b,"waffle-pivot-pill");b=b.parentNode)if(co(b,"waffle-pivot-pill-nodrag")){a.preventDefault();break}};r.Dob=function(a){var b=Mo(a.B).width;Co(a.K,b)};
r.Cob=function(a){var b,c,d,e,f=new L$("pivot-pill-changed",this);Yb(this.K,function(c,d){e=nb(c.childNodes,a.B);return 0<=e?(b=d,!0):!1});Yb(this.C,function(b,e){var l=vb(b,function(b){return b.getElement()==a.B}),m=nb(b,l);return l?(c=e,f.B=d=l,f.M=m,!0):!1});this.C[b]||(this.C[b]=[]);Eb(this.C[c],d);Bb(this.C[b],d,e);f.container=b;f.D=c;f.position=e;this.dispatchEvent(f)};
function ZFc(a,b){function c(a){a=h(a.Hz()-k);f[a]=!0}function d(a){a=h(a.Km());f[a]=!0}var e=a.Ga(),f={},h=v(kFc,a,SFc(a),Y$(a)),k=Y$(a).Fb();if(e)switch(b){case "filter":A(e.hs,c);break;case "row-breakout":case "col-breakout":A(e.dn,d),A(e.Gm,d)}return f}function PFc(a,b){var c=$Fc(a);if(c){var d=Y$(a),d=new Ch(d.Ob(),d.Fb(),d.Ob()+1,d.zc());al?aGc(a,d,b):ry(c.C,d,v(b,a),W(a))}else b.call(a)}function UFc(a,b){var c=$Fc(a);c?al?aGc(a,Y$(a),b):ry(c.C,Y$(a),v(b,a),W(a)):b.call(a)}
function aGc(a,b,c){b=py(xy($Fc(a)),b).addCallback(c,a);a.Ca.push(b);aj(b,xa(Eb,a.Ca,b))}function $Fc(a){var b=a.Ga();return xz(a.D.B,b.ym)}function SFc(a){return(a=$Fc(a))?a.vc():null}function Y$(a){return a.Ga().Nw(SFc(a))}function WFc(a,b,c){return wb(a.C[b],function(a){return c.getElement()==a.getElement()})}r.T=function(){X$.O.T.call(this);Vb(this.C,function(a){rf(a)});this.C={};Ff(this.M);this.M=null;J(this.Qa);J(this.La);A(this.Ca,vD)};function bGc(a,b){H.call(this);this.B=a;this.F=b;this.C=new M(this);I(this,this.C);this.C.L(a,"pivot-pill-created",this.D).L(a,"pivot-pill-model-updated",this.D)}y(bGc,H);bGc.prototype.G=function(a){var b=a.B;a=a.target.Ba();xFc(b);-1==a?b.gx():0<cGc(this,b).length&&!b.B?(zFc(b),b.B.getElement().focus(),dGc(this,b,-2,!0)):b.gx()};
bGc.prototype.J=function(a){var b=a.B;a=a.target;var c=fp(b.B,a),d=b.Z();for(c++;c<b.B.Bc();){var e=b.B.Jc(c),f=d.V9(e.getElement());co(f,"waffle-pivot-select-divider")&&d.removeNode(f);b.B.removeChild(e,!0)}(0>a.Ba()||!dGc(this,b,-2,!0))&&b.gx()};function eGc(a,b){a.C.L(b,"pivot-sort-by-change",a.G).L(b,"pivot-sort-key-change",a.J)}
bGc.prototype.D=function(a){var b=a.B;if(b instanceof V$){a=b.Ga();for(var c=0<cGc(this,b).length,d=XEc(this.B.Ga()),e=b.K,f=e.sj()-1;1<=f;f--)e.qE(f);e.xe(0).zJ(O$(b,a.Km()));e.nf(0);A(d,function(a,d){var f;if(sc(a,3))f=C(a,3);else if(1==K$(a)){f=C(a,5).getFunctionName();var m=O$(b,C(a,5).Km());f=c?f+(" of "+(m+" in...")):f+(" of "+m)}else f=aFc(C(a,6));e.We(new Sp(f,d))});sc(a,7)&&(d=C(a,7),a=yc(d,2),fGc(this,b,a)&&(d=C(d,1),e.Ma(d),c&&(zFc(b),A(a,v(function(a){dGc(this,b,a,!1)},this)),dGc(this,
b,-1,!1))));eGc(this,b)}};
function dGc(a,b,c,d){var e=gGc(a,b);if(0==e.length)return!1;var f=b.B.Bc();a=cGc(a,b);if(f>=a.length)return!1;var h=O$(b,a[f].Km()),f=b.Z();a=b.B.Bc();var k=new Fr,l=new Sp(h,-2);l.Da(!1);k.Ja(l,!0);k.Ja(new Sp(0==a?"Grand Total":"Total",-1),!0);for(l=0;l<e.length;l++)k.Ja(new Sp(e[l],l),!0);h=new bs(h,k,R$.getInstance(),f);h.Ma(-2);b.B.Ja(h,!0);0<a&&(a=f.qa("div",["goog-inline-block","waffle-pivot-select-divider"],":"),f.dF(a,h.getElement()));W(b).L(h,"action",b.cSa);f=c;"string"==typeof c&&(f=
nb(e,c),-1==f&&(f=-2));h.Ma(f);d&&(b.B.Of(h),h.Td(!0));return!0}function gGc(a,b){var c=hGc(a,b),d=yFc(b),e=d.length,f=[];A(c,function(a){a.length==e+1&&ub(d,function(b,c){return a[c]==b})&&Sb(f,a[e])});return f}function fGc(a,b,c){a=hGc(a,b);return 0==c.length||tb(a,function(a){return Qb(c,a)})}function cGc(a,b){return b.Gd()?a.B.Ga().Gm:a.B.Ga().dn}function hGc(a,b){return b.Gd()?vIa(a.B.Ga(),a.F):wIa(a.B.Ga(),a.F)};function iGc(a,b){Cw.call(this,1601,b,Eh(a.B));this.C=a}y(iGc,Cw);iGc.prototype.exec=ba();iGc.prototype.Qd=p(48);iGc.prototype.Nd=function(){var a=new aw,b=DIa(this.C);E(a,2,b);var b=this.C.B,c=new Uc;E(c,1,""+this.C.Er);c.uv(b.y);E(c,3,b.x);E(a,1,c);return a};function jGc(a,b,c,d,e){iY.call(this,a,c);this.F=this.K=null;this.B=a;this.C=b;this.R=d;this.P=e;this.X=new bGc(this.B,this.C);I(this,this.X);b=b.B;c=a.Z();this.U.L(a,"pivot-table-update",this.y$a).L(a,"pivot-pill-added",this.H5a).L(a,"pivot-pill-removed",this.wob).L(a,"pivot-pill-changed",this.vob).L(a,"pivot-aggregation-orientation-changed",this.YVa).L(Am,"show-pivot-ritz",this.yob).L(e,"activeCellChange",this.Wga).L(e,"click",this.zob,!0).L(e,"pivot_table_zippy_toggle",this.vab).L(b,"Nb",this.Wga).L(b,
"Qb",this.t8a).L(c.getElement("waffle-pivot-range-selection-button"),"click",this.c6a).L(c.getElement("waffle-pivot-range-selection-button"),"keypress",this.d6a).L(Ku(b),["Fb","Ta"],this.Wga)}y(jGc,iY);r=jGc.prototype;r.yh=function(){return Z.Ika};r.Bu=function(){return Z.Hka};r.c6a=function(){kGc(this)};r.d6a=function(a){13==a.keyCode&&(a.preventDefault(),a.stopPropagation(),kGc(this))};function kGc(a){YFc(a.B,v(a.xob,a,lGc(a)),ia)}
r.xob=function(a,b){a.ym=b.Rc;var c=ZEc(b.Rc,b.rect);a.ym=parseInt(C(c,1).eb(),10);a.C=c;Z$(this,a,this.B.J,!1);var c=a.Er,d=this.C.B;Bu(d)!=c&&oL(d,c)};r.yob=function(){var a;a=(a=this.C.B.B)&&0==a.getSheetType()?bS(this.C,a.eb(),lb(LA(a.vc()))):!1;if(a){var b=this.B;if(!b.Oa()){a=this.C.B.getActiveGrid();var c=$$(this);if(!c&&a){this.B.reset();var b=a.C,c=a.vc(),d=NA(c),e=LA(c);d?(al?ty(b,e,ac(Rg)):vy(b,e,ac(Rg),this.U)).addCallback(v(this.cEa,this,a)):this.cEa(a,c.Kc());return}this.F=c;b.Gf(c)}this.Bu().$b()}};
r.vob=function(a){var b=a.container,c=a.D,d=a.B,e=a.M,f=d,h=this.B.Ga().clone();if(d&&c&&b!=c){if(!d.Yna()){Z$(this,$$(this),!1,!0);return}f=mGc(this,d.Ga(),b);a:{var k=this.B,l;l=k.Ga().ym;switch(b){case "row-breakout":case "col-breakout":var m="row-breakout"==b,f=new V$(f,k.D,l,Y$(k),m,k.Z());break a;case "aggregation":f=new W$(f,k.D,l,Y$(k),k.Z());break a;case "filter":f=new S$(f,k.D,l,Y$(k),k.Z());break a;default:f=null}}f.render();RFc(this.B,d,f,b)}d=a.position;k=c==b;l=nGc(this,f.Ga());if(c)if(k){f=
f.Ga();switch(b){case "row-breakout":SEc(h.dn,f,d);break;case "col-breakout":SEc(h.Gm,f,d);break;case "filter":SEc(h.hs,f,d);break;case "aggregation":VEc(h,f,d)}Em("Field is now in position "+(d+1+"."))}else oGc(this,b,h,l,d);else pGc(this,b,f,h);c&&!k&&null!=e&&qGc(e,c,h);Z$(this,h,this.B.J,!!a.V)};
function mGc(a,b,c){switch(c){case "row-breakout":case "col-breakout":if(b instanceof fe)return b;break;case "aggregation":if(b instanceof ge)return b;break;case "filter":if(b instanceof $d)return b;break;default:return null}b=nGc(a,b);-1==b&&(b=0);switch(c){case "row-breakout":case "col-breakout":return c=new fe,E(c,1,b),c;case "aggregation":return c=new ge,a=new he,E(a,1,b),bFc(a,"SUM"),E(c,4,1),E(c,5,a),c;case "filter":return c=new $d,a=b+rGc(a).Fb(),E(c,1,a),c;default:return null}}
function nGc(a,b){if(b instanceof fe)return b.Km();if(b instanceof ge)switch(K$(b)){case 1:return C(b,5).Km();case 2:return-1;default:return 0}return b instanceof $d?b.Pg()-rGc(a).Fb():0}function rGc(a){var b=$$(a);return b.Nw(xz(a.C.B,b.ym).vc())}r.H5a=function(a){var b=a.container,c=lGc(this);oGc(this,b,c,a.K,a.position);Z$(this,c,this.B.J,!1);a=this.B;a.C[b]?(b=a.C[b],b=0<b.length?b[b.length-1]:null):b=null;b&&b.DDa()};
r.wob=function(a){var b=lGc(this);qGc(a.Ka,a.container,b);J(a.B);Z$(this,b,this.B.J,!1)};r.YVa=function(){var a=lGc(this),b=this.B.TI();a.D=b;Z$(this,a,this.B.J,!1)};
function oGc(a,b,c,d,e){switch(b){case "row-breakout":a=new fe;E(a,1,d);null!=e?Bb(c.dn,a,e):c.dn.push(a);break;case "col-breakout":a=new fe;E(a,1,d);null!=e?Bb(c.Gm,a,e):c.Gm.push(a);break;case "filter":b=xz(a.C.B,c.ym);if(!b)break;b=b.vc();b=uFc(d,c.Nw(b),b);var f=new $d;a=rGc(a).Fb()+d;E(f,1,a);sGc(f,b);null!=e?Bb(c.hs,f,e):c.hs.push(f);break;case "aggregation":b=new ge;if(-1==d){Z.Fka.$b();d=new ie;$Ec(d,"=");E(d,4,"SUM");E(b,4,2);E(b,6,d);d=XEc($$(a));for(var h=!1,f="",k=1;!h&&k<=d.length+1;k++){f=
"Calculated Field "+k;a:{for(var h=a,l=f,m=$$(h),n=m.zp,q=0;q<n.length;q++){var t=n[q];if(sc(t,3)&&l==C(t,3)){h=!0;break a}if(1==K$(t)){var w=xz(h.C.B,m.ym).vc();if(l==kFc(w,m.Nw(w),C(t,5).Km())){h=!0;break a}}}h=!1}h=!h}E(b,3,f)}else a=new he,E(a,1,d),bFc(a,"SUM"),E(b,4,1),E(b,5,a);YEc(c,b,e)}}function qGc(a,b,c){if(!(0>a))switch(b){case "row-breakout":Fb(c.dn,a);break;case "col-breakout":Fb(c.Gm,a);break;case "filter":Fb(c.hs,a);break;case "aggregation":WEc(c,a)}}
function pGc(a,b,c,d){if("aggregation"==b)a=WFc(a.B,b,c),d=d.zp[a],null!=d&&(a=c.D?c.D.Ba():null,null!=a&&E(d,3,a),1==K$(d)?bFc(C(d,5),c.Ba()):(jb(2==K$(d)),d=C(d,6),$Ec(d,c.Ba()),(a=IFc(c))?E(d,4,a):vc(d,4)));else if("filter"==b)d=vb(d.hs,function(a){return a.equals(c.Ga())}),null!=d&&sGc(d,MTb(U$(c),!0));else if(d=vb("row-breakout"==b?d.dn:d.Gm,function(a){return a.equals(c.Ga())}),null!=d)if(eFc(d,c.C.isChecked()),cFc(d,c.D.Ba()),-1!=c.K.Ba()){var e=new ee;J$(e,c.K.Ba());A(yFc(c),function(a){uc(e,
2,a)});fFc(e,c.D.Ba());E(d,7,e)}else vc(d,7)}r.y$a=function(){Z$(this,$$(this),!0,!1)};function Z$(a,b,c,d){b&&(c?(c=QC(a.C.B,b.Er),c=new iGc(b,c),a.R.B(c),a.K=null):a.K=b,c=a.B.Ga(),(d=d||!qh(c.B,b.B))&&a.B.reset(),a.B.Gf(b),d&&NFc(a.B))}r.cEa=function(a,b){var c=a.vc(),d=NA(c),c=LA(c);d&&b.equals(c)?YFc(this.B,v(this.Hra,this),v(this.Adb,this),!0):this.Hra(new Uh(a.eb(),a.B,b))};r.Adb=function(){this.yh().setVisible(!1);this.J.qc(3)};
r.Hra=function(a){var b;b=new je;var c=ZEc(0,new Ch(0,0,1,1));E(b,6,c);E(b,5,2);b=CIa(b,0,new N(0,0),0);b.ym=a.Rc;a=ZEc(a.Rc,a.rect);b.ym=parseInt(C(a,1).eb(),10);b.C=a;a=Bu(this.C.B);this.R.B(new oFc(b,a))};function $$(a){return a.K?a.K:(a=a.C.B.B)&&0==a.getSheetType()?OKa(a.vc()):null}function lGc(a){return(a=$$(a))?a.clone():null}
r.Wga=function(a){var b=$$(this);if(("Fb"==a.type||"Ta"==a.type)&&!b&&this.F&&(a=this.C.B.getActiveGrid())&&(this.B.Da(!0),a=a.vc(),a.Qb()==this.F.Er)){var c=this.F.B;c&&(OA(a,c),b=$$(this))}b?b.equals(this.F,this.C)||this.B.Gf(b):this.B.reset();this.F=b;a=!!b;cBb.B&&!this.yh().Oa()||this.yh().setVisible(a&&!Su(this.C));this.B.Da(!!b)};r.t8a=function(a){a=a.target;if(this.F&&this.F.Er==a.eb()&&this.B.Oa()){a=this.B;var b=dFa(a.ib);b&&a.M&&b.setVisible(!1)}};
r.zob=function(a){var b=a.target;if(co(b,jFc.XKa)||co(b,jFc.WKa)){var b=Wx(this.P).Ga(),c=BA(b,a.ag);tGc(this,b,c);a.stopPropagation()}};r.vab=function(a){var b=Wx(this.P).Ga();a=BA(b,a.ag);tGc(this,b,a)};
function tGc(a,b,c){if(!Su(a.C)){var d=yz(c);b=PKa(b,c);if(c=AIa(d)){var e=c.length-1;c=c[e];for(var d="r"==zIa(d)?b.dn[e]:b.Gm[e],e=yc(d,3),f,h=0;h<e.length;h++)if(e[h].Ba()==c){f=e[h];var k=!C(f,3);E(f,3,k)}f||(f=new de,f.Ma(c),E(f,3,!0),uc(d,3,f));Em(C(f,3)?"Pivot table field collapsed":"Pivot table field expanded");Z$(a,b,!0,!1)}}}function sGc(a,b){var c=new ae;vc(c,2);E(c,1,!1);A(b,function(a){uc(c,2,a)});E(a,2,c)}r.T=function(){jGc.O.T.call(this)};function uGc(){H.call(this)}y(uGc,qm);uGc.prototype.C=function(){return X$};uGc.prototype.B=function(){return jGc};ym("ritzpivottables",uGc);
